def blood_requests_for_hospital(hospitalId):
    query = """SELECT Orders.id as requestId, BloodBanks.name, Orders.date, BloodBanks.email, concat(BloodBanks.street, ',', Cities.name, ',', Governorates.name) , Orders.amount, Orders.type, Orders.bloodClass, Orders.status, string_agg(BloodCases.id::TEXT, ', ') AS bloodCases_list  FROM BloodBanks INNER JOIN Cities ON BloodBanks.cityId = Cities.id INNER JOIN Governorates ON Cities.governorateId = Governorates.id INNER JOIN Orders ON BloodBanks.id = Orders.bloodBankId LEFT JOIN BloodCases ON Orders.id = BloodCases.orderId WHERE Orders.hospitalId = {} Group by Orders.id, BloodBanks.name, Orders.date, BloodBanks.email, concat(BloodBanks.street, ',', Cities.name, ',', Governorates.name) , Orders.amount, Orders.type, Orders.bloodClass, Orders.status  ORDER BY Orders"""
    return query.format(hospitalId)
